(*codegen.File)(// Copyright 2022 Outreach Corporation. All Rights Reserved.
//
// Managed: true

local ok = import 'kubernetes/outreach.libsonnet';
local app = (import 'kubernetes/app.libsonnet').info('testing');

// Put custom global variables here
///Block(globalVars)

///EndBlock(globalVars)

// Configuration override for various environments go here.
local configurationOverride = {
	local this = self,
	// Environment level configuration override goes here.
	// Note: `development` and `local_development` refer to different
	// environments. `development` is _inside_ your local k8s cluster
	// while local_development is read by `devconfig.sh`
	environment: {
		local_development: self.development {
			configmap+: {
				data_+:: {
					ListenHost: '127.0.0.1',
					///Block(localDevelopmentConfig)

					///EndBlock(localDevelopmentConfig)
				},
			},
		},
		development: {
			configmap+: {
				data_+:: {
					///Block(developmentConfig)

					///EndBlock(developmentConfig)
				},
			},
		},
		///Block(environmentConfig)

		///EndBlock(environmentConfig)
	},

	// Bento level configuration override goes here.
	bento: {
		///Block(bentoConfig)

		///EndBlock(bentoConfig)
	},

	// Default configuration for all environments and bentos.
	default: {
		///Block(defaultConfig)
		configmap+: {
			data_+:: {
			},
		},
		///EndBlock(defaultConfig)
	},
};

// configuration merging logic
local env_config = if std.objectHas(configurationOverride.environment, app.environment) then configurationOverride.environment[app.environment] else {};
local bento_config = if std.objectHas(configurationOverride.bento, app.bento) then configurationOverride.bento[app.bento] else {};

// configuration is the computed value of this service's
// configuration block.
(configurationOverride.default + env_config + bento_config)
)
